<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="index.css">
    <title>Stock Calculator</title>
</head>

<body>
    <div class="main">
        <h2>Stock Calculator</h2>
        <div id="separator_line"></div>
        <br>
        <div id="internal_main">
            <div id="entry">


                <label for="transaction_type">Transaction Type</label> <br>
                <select name="type" id="type" onchange="navigate()">

                    <option value="sell.html"> Sell </option>
                    <option value="buy.html"> Buy </option>
                </select>
                <br><br>


                <label for="share-quantity">Share Quantity</label><br>
                <input type="number" id="quantity" name="quantity" placeholder="Number Only" required>
                <br><br>


                <label for="purchase_price">Purchase Price (Rs)</label><br>
                <input type="number" id="buyPrice" name="price" placeholder="Number Only" required>
                <input type="checkbox" id="wacc">
                <label for="Wacc">Is WACC Price ?</label>
                <br><br>


                <label for="share-quantity">Selling Price (Rs)</label><br>
                <input type="number" id="sellingPrice" name="quantity" placeholder="Number Only" required>
                <br><br>


                <label for="transaction_type">Investor Type</label> <br>
                <select id="inv" onchange="inst()">
                    <option value="Individual"> Individual </option>
                    <option value="Institutional"> Institutional </option>
                </select>
                <br>
                <br>


                <label for="transaction_type">Capital Gain</label> <br>
                <select id="capital">
                    <option value="5"> 5% </option>
                    <option value="7.5"> 7.5%</option>
                </select>
                <br>
                <br>


                <button onclick="calculate()">Calculate</button>
                <button onclick="Clear()">Clear</button>


            </div>



            <div id="result">
                <label for="details">Details:</label>
                <table border="1">
                    <tr>
                        <td>Investor Type</td>
                        <td id="investorType"></td>
                    </tr>
                    <tr>
                        <td>Total Amount</td>
                        <td id="totalAmount"></td>
                    </tr>
                    <tr>
                        <td>* Commission</td>
                        <td id="commission"></td>
                    </tr>
                    <tr>
                        <td>SEBON FEE</td>
                        <td id="sebon"></td>
                    </tr>
                    <tr>
                        <td>DP Charge</td>
                        <td id="dp"></td>
                    </tr>
                    <tr>
                        <td>Total Amount Receivable (Rs)</td>
                        <td id="amount"></td>
                    </tr>
                    <tr>
                        <td>Capital Gain Tax <span id="tax"></span> % (Rs) </td>
                        <td id="cgt"></td>
                    </tr>
                    <tr>
                        <td>Profit/Loss (Rs)</td>
                        <td id="pl"></td>
                    </tr>
                </table>
            </div>
        </div>
    </div>

    <script>
        function calculate() {
            //getting data
            let sq = parseFloat(document.getElementById("quantity").value);
            let pp = parseFloat(document.getElementById("buyPrice").value);
            let sp = parseFloat(document.getElementById("sellingPrice").value);

            //totalSellingAmount
            total = sq * sp;
            totalAmount.textContent = total;

            //Investor Type
            var it = document.getElementById("inv").value;
            investorType.textContent = it;

            // showing CGT percentage
            var capital = document.getElementById("capital").value;
            tax.textContent = capital;

            //showing commission
            if (total <= 50000) {
                comm = 0.004 * total;
            }
            else if (total > 50000 && total <= 500000) {
                comm = 0.0037 * total;
            }
            else if (total > 500000 && total <= 2000000) {
                comm = 0.0034 * total;
            }
            else if (total > 2000000 && total <= 10000000) {
                comm = 0.003 * total;
            }
            else {
                comm = 0.0027 * total;
            }

            commission.textContent = comm;

            //showing sebon fee
            let sebonFee = 0.00015 * total;
            sebon.textContent = sebonFee;

            //showing dpfee
            const dpfee = parseFloat(25);
            dp.textContent = dpfee;

            var costPerShareAfter = (total - comm - sebonFee - dpfee) / sq;


            if (wacc.checked) {
                let costPerShare = document.getElementById("buyPrice").value;
                if (costPerShareAfter > costPerShare) {
                    var capitaltax = capital * (costPerShareAfter - costPerShare) * sq / 100;
                }


                cgt.textContent = capitaltax;
            }
            else {
            //totalBuyingAmount
            var totalBuyingAmount = sq * pp;
            if (totalBuyingAmount <= 50000) {
                commi = 0.004 * totalBuyingAmount;
            }
            else if (totalBuyingAmount > 50000 && totalBuyingAmount <= 500000) {
                commi = 0.0037 * totalBuyingAmount;
            }
            else if (totalBuyingAmount > 500000 && totalBuyingAmount <= 2000000) {
                commi = 0.0034 * totalBuyingAmount;
            }
            else if (totalBuyingAmount > 2000000 && totalBuyingAmount <= 10000000) {
                commi = 0.003 * totalBuyingAmount;
            }
            else {
                commi = 0.0027 * totalBuyingAmount;
            }
            const dpFee = parseFloat(25);
            let sFee = 0.00015 * totalBuyingAmount;
            let totBuy = dpFee + totalBuyingAmount + commi + sFee;
            let costPerShare = totBuy / sq;

            //calculating capital gain tax
            // var capitalGainTax = document.getElementById("capital").value;
            if (costPerShareAfter > costPerShare) {
                var capitaltax = capital * (costPerShareAfter - costPerShare) * sq / 100;
            }


            cgt.textContent = capitaltax;
        }
            
        }



        function Clear() {
            document.getElementById("price").value = "";
            document.getElementById("quantity").value = "";
            // var i = document.getElementById("price");
            // i.value="";
            // quantity.textContent="";
            // price.textContent="";
        }

        function navigate() {
            var selectElement = document.getElementById("type");
            var selectedValue = selectElement.value;

            // Check if a valid option is selected
            if (selectedValue) {
                // Redirect to the selected page
                window.location.href = selectedValue;
            }
        }

        function inst() {
            var sel = document.getElementById("inv");
            var cap = document.getElementById("capital");
            if (sel.value === "Institutional") {
                cap.innerHTML = '<option value="10">10%</option>';
            } else {
                cap.innerHTML = '<option value="5">5%</option><option value="7.5">7.5%</option>';
            }
            inst();
        }

    </script>

</body>



</html>